"use strict";angular.module("minionatorNgApp",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl",controllerAs:"main"}).when("/:class",{templateUrl:"views/main.html",controller:"MainCtrl",controllerAs:"main"}).when("/:class/:type",{templateUrl:"views/type.html",controller:"TypeCtrl",controllerAs:"type"}).when("/:class/:type/:instance",{templateUrl:"views/instance.html",controller:"InstanceCtrl",controllerAs:"instance"}).otherwise({redirectTo:"/"})}]),angular.module("minionatorNgApp").controller("MainCtrl",["$scope","$routeParams","SlaveHealth",function(a,b,c){b["class"]&&(a.slaveclass=b["class"]),c.summary({},function(b){a.summary=b})}]),angular.module("minionatorNgApp").controller("TypeCtrl",["$scope","$routeParams","SlaveHealth",function(a,b,c){a["class"]=b["class"],a.slavetype=b.type,c.classtype({classtype:b["class"]+"-"+b.type},function(b){a.states={working:0,idle:0,broken:0,disabled:0,staging:0,decommissioned:0,not_in_slavealloc:0};for(var c in b)b[c].slave_state&&(a.states[b[c].slave_state]+=1);a.data=b})}]),angular.module("minionatorNgApp").controller("InstanceCtrl",["$scope","$routeParams","Build",function(a,b,c){b["class"]&&(a.slaveclass=b["class"]),b.type&&(a.slavetype=b.type),b.instance&&(a.instanceName=b.instance,c.query({hostname:b.instance},function(b){a.builds=b}))}]),angular.module("minionatorNgApp").factory("Build",["$resource",function(a){var b="https://secure.pub.build.mozilla.org/buildapi/recent/:hostname?format=json&numbuilds=100&greedy=false";return a(b,{hostname:"@_hostname"},{headers:{Accept:"application/json"}})}]),angular.module("minionatorNgApp").factory("SlaveHealth",["$resource",function(a){var b="https://secure.pub.build.mozilla.org/builddata/reports/slave_health/json";return a(b,{classtype:"@_classtype"},{headers:{Accept:"application/json"},classtype:{url:b+"/:classtype.json",isArray:!1},query:{url:b+"/all_slaves.json",isArray:!1},summary:{url:b+"/slave_state_rollup.json",isArray:!1}})}]),angular.module("minionatorNgApp").run(["$templateCache",function(a){a.put("views/instance.html",'<div class="text-center" ng-show="!instanceName"> <i class="fa fa-spinner fa-spin"></i> </div> <div ng-show="instanceName"> <h1> <a ng-href="#/"> <i class="fa fa-heartbeat"></i> dash </a> / <a ng-href="#/{{class}}"> <i class="fa" ng-class="{\n'+"        'fa-wrench': (class === 'build'),\n        'fa-tachometer': (class === 'test'),\n        'fa-balance-scale': (class === 'try')}\"></i> {{class}} </a> / <a ng-href=\"#/{{class}}/{{slavetype}}\"> <i class=\"fa\" ng-class=\"{\n        'fa-windows': (slavetype.indexOf('-2008-') > 0 || slavetype.indexOf('-w') > 0 || slavetype.indexOf('-xp') > 0),\n        'fa-linux': (slavetype.indexOf('-linux') > 0),\n        'fa-apple': (slavetype.indexOf('-lion-') > 0 || slavetype.indexOf('-snow-') > 0 || slavetype.indexOf('-yosemite-') > 0),\n        'fa-android': (slavetype.indexOf('-emulator') > 0 || slavetype === 'panda')}\"></i> {{slavetype}} </a> / <i class=\"fa\" ng-class=\"{\n      'fa-desktop': (slavetype.indexOf('-emulator') < 0 && slavetype !== 'panda'),\n      'fa-mobile': (slavetype.indexOf('-emulator') > 0 || slavetype === 'panda')}\"></i> {{instanceName}} </h1> <pre>{{builds | json}}</pre> </div>"),a.put("views/main.html",'<div class="text-center" ng-show="!summary"> <i class="fa fa-spinner fa-spin"></i> </div> <div> <div ng-repeat="(class, stats) in summary" ng-show="class !== \'metadata\' && ((slaveclass === class) || !slaveclass)" ng-class="{\'col-md-4\': !slaveclass}"> <h2> <a ng-href="#/" ng-show="slaveclass"> <i class="fa fa-heartbeat"></i> dash </a> <span ng-show="slaveclass">/</span> <a ng-href="#/{{class}}" ng-show="!slaveclass"> <i class="fa" ng-class="{\n          \'fa-wrench\': (class === \'build\'),\n          \'fa-tachometer\': (class === \'test\'),\n          \'fa-balance-scale\': (class === \'try\')}"></i> {{class}} </a> <span ng-show="slaveclass"> <i class="fa" ng-class="{\n          \'fa-wrench\': (class === \'build\'),\n          \'fa-tachometer\': (class === \'test\'),\n          \'fa-balance-scale\': (class === \'try\')}"></i> {{class}} </span> </h2> <ul class="list-unstyled"> <li ng-repeat="(type, counts) in stats" ng-show="counts.working||counts.idle||counts.disabled||counts.broken" ng-class="{\'col-md-4\': slaveclass}"> <div class="panel panel-default"> <div class="panel-heading"> <a class="panel-title" ng-href="#/{{class}}/{{type}}"> <i class="fa" ng-class="{\n'+"                'fa-windows': (type.indexOf('-2008-') > 0 || type.indexOf('-w') > 0 || type.indexOf('-xp') > 0),\n                'fa-linux': (type.indexOf('-linux') > 0),\n                'fa-apple': (type.indexOf('-lion-') > 0 || type.indexOf('-snow-') > 0 || type.indexOf('-yosemite-') > 0),\n                'fa-android': (type.indexOf('-emulator') > 0 || type === 'panda')}\"></i> <strong>{{type}}</strong> </a> <button type=\"button\" class=\"btn btn-xs btn-default pull-right\" ng-click=\"counts.show = !counts.show\"> <i class=\"fa\" ng-class=\"{'fa-expand': !counts.show, 'fa-compress': counts.show}\"></i> </button> <span ng-repeat=\"(name, count) in counts track by $index\" title=\"{{name}}\" ng-show=\"count && (name !== 'show')\" style=\"margin-right: 4px\" class=\"label pull-right\" ng-class=\"{\n              'label-success': (name === 'working'),\n              'label-warning': (name === 'idle'),\n              'label-info': (name === 'disabled'),\n              'label-danger': (name === 'broken'),\n              'label-default': (['broken', 'disabled', 'working'].indexOf() < 0)}\"> <i class=\"fa\" ng-class=\"{\n                'fa-eraser': (name === 'decommissioned'),\n                'fa-cogs': (name === 'working'),\n                'fa-chain-broken': (name === 'not_in_slavealloc'),\n                'fa-check-square-o': (name === 'staging'),\n                'fa-stop': (name === 'disabled'),\n                'fa-clock-o': (name === 'idle'),\n                'fa-frown-o': (name === 'broken')}\"></i> <span class=\"\">{{count}}</span> </span> </div> <div class=\"panel-body\" ng-show=\"counts.show\"> </div> </div> </li> </ul> </div> </div> <div class=\"text-right\"> <p> <i class=\"fa fa-camera\"></i> {{summary.metadata.generated | date:'yyyy-MM-dd HH:mm:ss Z'}} snapshot &nbsp; </p> </div>"),a.put("views/type.html",'<div> <h1> <a ng-href="#/"> <i class="fa fa-heartbeat"></i> dash </a> / <a ng-href="#/{{class}}"> <i class="fa" ng-class="{\n'+"        'fa-wrench': (class === 'build'),\n        'fa-tachometer': (class === 'test'),\n        'fa-balance-scale': (class === 'try')}\"></i> {{class}} </a> / <i class=\"fa\" ng-class=\"{\n      'fa-windows': (slavetype.indexOf('-2008-') > 0 || slavetype.indexOf('-w') > 0 || slavetype.indexOf('-xp') > 0),\n      'fa-linux': (slavetype.indexOf('-linux') > 0),\n      'fa-apple': (slavetype.indexOf('-lion-') > 0 || slavetype.indexOf('-snow-') > 0 || slavetype.indexOf('-yosemite-') > 0),\n      'fa-android': (slavetype.indexOf('-emulator') > 0 || slavetype === 'panda')}\"></i> {{slavetype}} </h1> <div class=\"text-center\" ng-show=\"!data\"> <i class=\"fa fa-spinner fa-spin\"></i> </div> <div ng-repeat=\"(state, count) in states\" class=\"clearfix\" ng-show=\"data && count\"> <h2> <i class=\"fa\" ng-class=\"{\n        'fa-eraser': (state === 'decommissioned'),\n        'fa-cogs': (state === 'working'),\n        'fa-chain-broken': (state === 'not_in_slavealloc'),\n        'fa-wrench': (state === 'staging'),\n        'fa-stop': (state === 'disabled'),\n        'fa-clock-o': (state === 'idle'),\n        'fa-frown-o': (state === 'broken')}\"></i> {{state}} </h2> <div ng-repeat=\"(hostname, stats) in data\" ng-show=\"stats.slave_state === state\" class=\"col-md-3\"> <div class=\"panel\" ng-class=\"{\n        'panel-default': (state === 'decommissioned'),\n        'panel-success': (state === 'working'),\n        'panel-default': (state === 'not_in_slavealloc'),\n        'panel-default': (state === 'staging'),\n        'panel-info': (state === 'disabled'),\n        'panel-warning': (state === 'idle'),\n        'panel-danger': (state === 'broken')}\"> <div class=\"panel-heading\"> <a class=\"panel-title\" ng-href=\"#/{{class}}/{{slavetype}}/{{hostname}}\"> <strong>{{hostname}}</strong> </a> <button type=\"button\" class=\"btn btn-xs btn-default pull-right\" ng-click=\"stats.show = !stats.show\"> <i class=\"fa\" ng-class=\"{'fa-expand': !stats.show, 'fa-compress': stats.show}\"></i> </button> </div> <div class=\"panel-body\" ng-show=\"stats.show\"> <div ng-show=\"stats.elapsed_on_job\"> elapsed: {{stats.elapsed_on_job}} </div> <div ng-show=\"stats.elapsed_since_job\"> time since last job: {{stats.elapsed_since_job}} </div> <div ng-show=\"stats.starttime\"> start time: {{stats.starttime}} </div> <div ng-show=\"stats.master.indexOf('http://None') < 0\" ng-bind-html=\"stats.master\"> </div> <div ng-show=\"stats.notes\"> {{stats.notes}} </div> </div> </div> </div> </div> </div>")}]);